IF(WIN32)
  ADD_DEFINITIONS(-DWIN32)
ENDIF(WIN32)

SET(EPSILON 0.01)


SET(EXPLOITATION_TESTS ${CXX_TEST_PATH}/otbExploitationTests)


ADD_TEST(otbSpectralResponseNew ${EXPLOITATION_TESTS}
        otbSpectralResponseNew
        )

ADD_TEST(otbSpectralResponse ${EXPLOITATION_TESTS}
        otbSpectralResponse
        ${RSR_DATA}/BD-CNES/JHU/becknic/manmade/txt/0092uuu.txt
        2.5 #lambda
        )

ADD_TEST(otbSatelliteRSRNew ${EXPLOITATION_TESTS}
        otbSatelliteRSRNew
        )

ADD_TEST(otbSatelliteRSR ${EXPLOITATION_TESTS}
        otbSatelliteRSR
        ${RSR_DATA}/Rsr/SPOT5/HRG2/rep6S.dat
        4 #nb band
        2.5 #lambda
        2 #num band
        )

ADD_TEST(otbReduceSpectralResponseNew ${EXPLOITATION_TESTS}
        otbReduceSpectralResponseNew
        )

ADD_TEST(otbReduceSpectralResponse ${EXPLOITATION_TESTS}
        otbReduceSpectralResponse
        ${RSR_DATA}/BD-CNES/jpl/beckman/minerals/Arsenate/txt/A01Ac.txt
        ${RSR_DATA}/Rsr/SPOT5/HRG2/rep6S.dat
        4 #nb band
        )

ADD_TEST(otbReduceSpectralResponseClassifierRAndNIR ${EXPLOITATION_TESTS}
        otbReduceSpectralResponseClassifierRAndNIR
        ${RSR_DATA}/BD-CNES/JHU/becknic/manmade/txt/0092uuu.txt
        ${RSR_DATA}/Rsr/SPOT5/HRG2/rep6S.dat
        4 #nb band
        1 #red index
        2 #NIR index
        )

ADD_TEST(otbAtmosphericCorrectionsReduceSpectralResponseNew ${EXPLOITATION_TESTS}
        otbAtmosphericCorrectionsReduceSpectralResponseNew
        )
        
ADD_TEST(otbAtmosphericEffects ${EXPLOITATION_TESTS}
        otbAtmosphericEffects
        ${RSR_DATA}/BD-CNES/JHU/becknic/manmade/txt/0092uuu.txt
        ${RSR_DATA}/Rsr/SPOT5/HRG2/rep6S.dat
        4 #nb band
        4 #day
        12 #month
        27.3 #zenithSolarAngle
        152.7 #azimutSolarAngle
        2.5 #viewingZenitalAngle
        -77.0 #viewingAzimutalAngle
        1013. #atmoPressure
        2.48134 #waterVaporAmount
        0.34400 #ozoneAmount
        1 #aerosolModelValue
        0.199854 #aerosolOptical
        )

ADD_TEST(otbSpatialisationTest ${EXPLOITATION_TESTS}
        otbSpatialisationTest
        ${RSR_DATA}/Shapefile/stickPolygons.shp
        ${TEMP}/VectorDataToLabelImage.tif
        )
        
ADD_TEST(otbLabelMapToSimulatedImageFilterTest ${EXPLOITATION_TESTS}
        otbLabelMapToSimulatedImageFilterTest
        ${RSR_DATA}/Shapefile/culturesWithAndWithoutPath.shp
#         /home2/arnaud/PROJETS/SimuCapteur/data/largeInput.shp
        ${RSR_DATA}/Rsr/SPOT5/HRG2/rep6S.dat
        4 #nb bands
        ${RSR_DATA}/BD-CNES/jpl/beckman/minerals/ #root path of spectrum
        ${TEMP}/LabelMapToSimulatedImageFilterTest.tif
        )
        
ADD_TEST(otbImageSimulationMethodTest ${EXPLOITATION_TESTS}
        otbImageSimulationMethodTest
        ${RSR_DATA}/Shapefile/stickPolygons.shp
        ${BASELINE_FILES}/svmLearningImage.tif
        ${RSR_DATA}/Rsr/SPOT5/HRG2/rep6S.dat
        4 #nb bands
        ${RSR_DATA}/BD-CNES/ #root path of spectrum
        3 #prolate radius
        ${TEMP}/ImageSimulationMethodTest.tif
        )
 
ADD_TEST(otbImageSimulationMethodTest2 ${EXPLOITATION_TESTS}
        otbImageSimulationMethodTest2
        ${RSR_DATA}/Shapefile/culturesWithAndWithoutPath.shp
        ${BASELINE_FILES}/svmLearningImage.tif
        ${RSR_DATA}/Rsr/SPOT5/HRG2/rep6S.dat
        4 #nb bands
        ${RSR_DATA}/BD-CNES/ #root path of spectrum
        3 #prolate radius
        ${TEMP}/ImageSimulationMethodTest2.tif
        ) 
 
SET(EXPLOITATION_SRCS
otbExploitationTests.cxx
otbSpectralResponseNew.cxx
otbSpectralResponse.cxx
otbSatelliteRSRNew.cxx
otbSatelliteRSR.cxx
otbReduceSpectralResponseNew.cxx
otbReduceSpectralResponse.cxx
otbReduceSpectralResponseClassifierRAndNIR.cxx
otbAtmosphericCorrectionsReduceSpectralResponseNew.cxx
otbAtmosphericEffects.cxx
otbSpatialisationTest.cxx
otbLabelMapToSimulatedImageFilterTest.cxx
otbImageSimulationMethodTest.cxx
otbImageSimulationMethodTest2.cxx
)


ADD_EXECUTABLE(otbExploitationTests ${EXPLOITATION_SRCS})
TARGET_LINK_LIBRARIES(otbExploitationTests OTBIO OTBCommon OTBRadiometry OTBTesting OTBLearning PROSAIL)
